ç©ºæ°£æœ€å¥½éƒ½å¸‚ = 
ADDCOLUMNS(
    'dim_å…­éƒ½ç¸£å¸‚',
    
    -- è‰¯å¥½å¤©æ•¸ï¼ˆGood + Moderateï¼‰
    "è‰¯å¥½",
    CALCULATE(
        COUNTROWS(air_quality),
        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
        air_quality[status] IN {"good", "moderate"}
    ),

    -- ä¸è‰¯å¤©æ•¸ï¼ˆUnhealthy levelsï¼‰
    "ä¸è‰¯",
    CALCULATE(
                        COUNTROWS(air_quality),
                        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
                        air_quality[status] IN {"unhealthy for sensitive groups", "unhealthy", "very unhealthy"}
    ),

    -- è‰¯ç‡
    "è‰¯ç‡",
    VAR goodCount = CALCULATE(
        COUNTROWS(air_quality),
        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
        air_quality[status] IN {"good", "moderate"}
    )
    VAR badCount = CALCULATE(
        COUNTROWS(air_quality),
        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
        air_quality[status] IN {"unhealthy for sensitive groups", "unhealthy", "very unhealthy"}
    )
    RETURN DIVIDE(goodCount, goodCount + badCount)
)




ç©ºæ°£æœ€å¥½éƒ½å¸‚ = ADDCOLUMNS('dim_å…­éƒ½ç¸£å¸‚',
        "è‰¯å¥½",
        var x = countax(FILTER(air_quality,'air_quality'[county] = 'dim_å…­éƒ½ç¸£å¸‚'[county] && 'air_quality'[status] IN {"good", "moderate"}),
        air_quality[status])
		return x,
	
        "ä¸è‰¯",
        var y = countax(FILTER(air_quality,'air_quality'[county] = 'dim_å…­éƒ½ç¸£å¸‚'[county] && 'air_quality'[status] IN {"unhealthy for sensitive groups", "unhealthy","very unhealthy"}),
        air_quality[status])
		return y,
	
        "è‰¯ç‡",
        var z = countax(FILTER(air_quality,'air_quality'[county] = 'dim_å…­éƒ½ç¸£å¸‚'[county] && 'air_quality'[status] IN {"good", "moderate"}),
        air_quality[status]) / (countax(FILTER(air_quality,'air_quality'[county] = 'dim_å…­éƒ½ç¸£å¸‚'[county] && 'air_quality'[status] IN {"unhealthy for sensitive groups", "unhealthy","very unhealthy"}),
        air_quality[status]) + countax(FILTER(air_quality,'air_quality'[county] = 'dim_å…­éƒ½ç¸£å¸‚'[county] && 'air_quality'[status] IN {"good", "moderate"}),
        air_quality[status]))
		return z
        )



ç©ºæ°£æœ€å¥½éƒ½å¸‚ :=
SELECTCOLUMNS(
    ADDCOLUMNS(
        'dim_å…­éƒ½ç¸£å¸‚',
        
        "goodCount",
        CALCULATE(
            COUNTROWS(air_quality),
            USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
            air_quality[status] IN {"good", "moderate"}
        ),

        "badCount",
        CALCULATE(
            COUNTROWS(air_quality),
            USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
            air_quality[status] IN {"unhealthy for sensitive groups", "unhealthy", "very unhealthy"}
        )
    ),
    
    -- æœ€çµ‚è¦é¡¯ç¤ºçš„æ¬„ä½
    "ç¸£å¸‚", [county],
    "è‰¯å¥½", [goodCount],
    "ä¸è‰¯", [badCount],
    "è‰¯ç‡", DIVIDE([goodCount], [goodCount] + [badCount])
)






        ä½ é€™å€‹ DAX æ˜¯æƒ³åšä¸€å¼µè¡¨ï¼Œé¡¯ç¤ºå…­éƒ½ç¸£å¸‚çš„ç©ºæ°£ç‹€æ³çµ±è¨ˆï¼ˆè‰¯å¥½ã€ä¸è‰¯ã€è‰¯ç‡ï¼‰ã€‚
ä½ ç›®å‰æ˜¯ç”¨ FILTER + air_quality[county] = 'dim_å…­éƒ½ç¸£å¸‚'[county] ä¾†æ‰‹å‹•å»ºç«‹é—œè¯ï¼Œä½†é€™ç¨®å¯«æ³•æœƒï¼š

é‡è¤‡é‹ç®—

æ²’æœ‰å–„ç”¨è³‡æ–™æ¨¡å‹çš„é—œè¯æ€§ï¼ˆæ•ˆç‡ä½ï¼‰

ç„¡æ³•ä½¿ç”¨ç¾æœ‰é—œè¯æˆ–éä½œç”¨ä¸­é—œè¯ï¼ˆinactive relationshipï¼‰

âœ… è§£æ³•ï¼šä½¿ç”¨ USERELATIONSHIP æ­é… CALCULATE æé«˜æ•ˆèƒ½èˆ‡å¯è®€æ€§
é¦–å…ˆï¼Œä½ å¿…é ˆç¢ºä¿ï¼š

dim_å…­éƒ½ç¸£å¸‚[county] èˆ‡ air_quality[county] æœ‰é—œè¯

å¦‚æœé‚£æ¢é—œè¯æ˜¯éä½œç”¨ä¸­çš„ï¼ˆInactiveï¼‰ï¼Œå°±è¦ç”¨ USERELATIONSHIP æ˜ç¢ºå•Ÿç”¨å®ƒ

âœ… æ”¹å¯«ç¯„ä¾‹ï¼ˆæœ€ä½³åŒ–ç‰ˆï¼‰
DAX
è¤‡è£½
ç·¨è¼¯
ç©ºæ°£æœ€å¥½éƒ½å¸‚ :=
ADDCOLUMNS(
    'dim_å…­éƒ½ç¸£å¸‚',
    
    -- è‰¯å¥½å¤©æ•¸ï¼ˆGood + Moderateï¼‰
    "è‰¯å¥½",
    CALCULATE(
        COUNTROWS(air_quality),
        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
        air_quality[status] IN {"good", "moderate"}
    ),

    -- ä¸è‰¯å¤©æ•¸ï¼ˆUnhealthy levelsï¼‰
    "ä¸è‰¯",
    CALCULATE(
        COUNTROWS(air_quality),
        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
        air_quality[status] IN {"unhealthy for sensitive groups", "unhealthy", "very unhealthy"}
    ),

    -- è‰¯ç‡
    "è‰¯ç‡",
    VAR goodCount = CALCULATE(
        COUNTROWS(air_quality),
        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
        air_quality[status] IN {"good", "moderate"}
    )
    VAR badCount = CALCULATE(
        COUNTROWS(air_quality),
        USERELATIONSHIP('dim_å…­éƒ½ç¸£å¸‚'[county], air_quality[county]),
        air_quality[status] IN {"unhealthy for sensitive groups", "unhealthy", "very unhealthy"}
    )
    RETURN DIVIDE(goodCount, goodCount + badCount)
)
ğŸ§  èªªæ˜é‡é»
åŸå¯«æ³•	æ”¹å¯«å¾Œ
FILTER() æ¯æ¬¡é‡è¤‡è³‡æ–™æƒæ	ä½¿ç”¨ CALCULATE + USERELATIONSHIP é«˜æ•ˆå‘¼å«é—œè¯
COUNTAX(..., air_quality[status])	ç°¡åŒ–ç‚º COUNTROWS()ï¼Œå› ç‚ºæ²’å¿…è¦
ä½¿ç”¨éœæ…‹é—œè¯ =, æ•ˆèƒ½å·®	USERELATIONSHIP å•Ÿç”¨æ¨¡å‹ä¸­çš„éä¸»å‹•é—œè¯

ğŸ“Œ å°æç¤ºï¼š
è‹¥æ¨¡å‹ä¸­è©²é—œè¯æ˜¯ä¸»å‹•ï¼ˆActiveï¼‰é—œè¯ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨ USERELATIONSHIPã€‚

å¦‚æœä½ å¸Œæœ›æŠŠé€™å€‹è¡¨ç”¨æ–¼è¦–è¦ºåŒ–ï¼ˆä¾‹å¦‚æ¢ç‹€åœ–ï¼‰ï¼Œé€™ç¨®å¯«æ³•æœƒé‹ç®—æ›´å¿«ã€é¡¯ç¤ºä¹Ÿæ›´ç©©å®šã€‚